# Результаты бенчмарка v4

## Сводная таблица

| #  | Запрос                               | Категория   | SwiftIndex v4 | Изменение vs v3 | Примечание                          |
| -- | ------------------------------------ | ----------- | ------------- | --------------- | ----------------------------------- |
| 1  | `HybridSearchEngine`                 | A: Точный   | 5/5 ✓         | =               | Идеально                            |
| 2  | `USearchError`                       | A: Точный   | 0/5           | =               | **Не исправлено**. Матчит "Search". |
| 3  | `EmbeddingProvider`                  | A: Точный   | 5/5 ✓         | =               | Идеально                            |
| 4  | `rrfK`                               | A: Точный   | 5/5 ✓         | =               | Идеально                            |
| 5  | `text vectorization`                 | B: Синоним  | 5/5 ✓         | =               | Идеально                            |
| 6  | `store vectors persistently`         | B: Синоним  | 5/5 ✓         | =               | Идеально                            |
| 7  | `nearest neighbor search`            | B: Синоним  | 3/5           | =               | Матчит `Comparable` из-за "search"  |
| 8  | `combine search results`             | B: Синоним  | 5/5 ✓         | =               | Идеально                            |
| 9  | `how does search ranking work`       | C: Концепт  | 5/5 ✓         | =               | Идеально                            |
| 10 | `how are code chunks parsed`         | C: Концепт  | 5/5 ✓         | =               | Идеально                            |
| 11 | `what happens when file indexed`     | C: Концепт  | 5/5 ✓         | =               | Идеально                            |
| 12 | `how are embedding failures handled` | C: Концепт  | 4/5           | =               | Хорошо                              |
| 13 | `actor pattern for thread safety`    | D: Паттерн  | 5/5 ✓         | =               | Идеально                            |
| 14 | `what implements ChunkStore`         | D: Паттерн  | 4/5 ✓         | =               | `MockChunkStore` найден             |
| 15 | `how are providers configured`       | D: Паттерн  | 5/5 ✓         | =               | Идеально                            |
| 16 | `where is caching used`              | D: Паттерн  | 5/5 ✓         | =               | Идеально                            |
| 17 | `async await concurrency`            | E: Сквозной | 5/5 ✓         | =               | Идеально                            |
| 18 | `error types and handling`           | E: Сквозной | 5/5 ✓         | =               | Идеально                            |
| 19 | `TOML config loading validation`     | E: Сквозной | 5/5 ✓         | =               | Идеально                            |
| 20 | `how is search engine tested`        | E: Сквозной | 5/5 ✓         | =               | Идеально                            |

## Детальный анализ изменений

### Стабильность

Результаты практически идентичны v3. Средний P@5 остался на уровне **4.55/5**.

### Проблема `USearchError`

Несмотря на "improve-exact-term-search", запрос `USearchError` всё ещё возвращает 0 релевантных результатов из топ-5.
Результаты забиты частичными совпадениями по слову "Search" (`BM25Search`, `TOMLConfig.search` и т.д.).
Это указывает на то, что токенизатор разбивает `USearchError` (CamelCase splitting), и частичные совпадения по частому токену "Search" перевешивают точный (но, возможно, отсутствующий как единый токен в индексе) термин.

### Проблема `implements ChunkStore`

В v3 `GRDBChunkStore` был на 3 месте. В v4 он выпал из топ-5, уступив место `MockChunkStore` и повторным упоминаниям протокола. Это вариативность ранжирования, но семантически ответ всё ещё верный (Mock реализация найдена).

## Сравнение версий

| Версия | Avg P@5 | Побед | Ничьих | Поражений | Комментарий                       |
| ------ | ------- | ----- | ------ | --------- | --------------------------------- |
| v1     | 3.9     | 8     | 7      | 5         | Baseline                          |
| v2     | 4.35    | 13    | 3      | 4         | RRF Fusion                        |
| v3     | 4.55    | 15    | 3      | 2         | Type Declarations                 |
| v4     | 4.55    | 15    | 3      | 2         | Exact Search (без явного эффекта) |

**Вывод**: Текущие изменения не решили проблему поиска редких CamelCase терминов, которые содержат частые подстроки (как Error или Search).
